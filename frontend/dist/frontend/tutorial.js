"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[781],{1143:(fe,H,w)=>{w.r(H),w.d(H,{hasInstructions:()=>ce,startHackingInstructorFor:()=>he});var s=w(467),q={"":["<em>","</em>"],_:["<strong>","</strong>"],"\n":["<br />"]," ":["<br />"],"-":["<hr />"]};function M(t){return t.replace(RegExp("^"+(t.match(/^(\t| )+/)||"")[0],"gm"),"")}function k(t){return(t+"").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}const N=function T(t){var p,g,n,b,h,o=/((?:^|\n+)(?:\n---+|\* \*(?: \*)+)\n)|(?:^```(\w*)\n([\s\S]*?)\n```$)|((?:(?:^|\n+)(?:\t|  {2,}).+)+\n*)|((?:(?:^|\n)([>*+-]|\d+\.)\s+.*)+)|(?:\!\[([^\]]*?)\]\(([^\)]+?)\))|(\[)|(\](?:\(([^\)]+?)\))?)|(?:(?:^|\n+)([^\s].*)\n(\-{3,}|={3,})(?:\n+|$))|(?:(?:^|\n+)(#{1,3})\s*(.+)(?:\n+|$))|(?:`([^`].*?)`)|(  \n\n*|\n{2,}|__|\*\*|[_*])/gm,r=[],a="",c=0,f={};function Y(m){var y=q[m.replace(/\*/g,"_")[1]||""],A=r[r.length-1]==m;return y?y[1]?(r[A?"pop":"push"](m),y[0|A]):y[0]:m}function R(){for(var m="";r.length;)m+=Y(r[r.length-1]);return m}for(t=t.replace(/^\[(.+?)\]:\s*(.+)$/gm,function(m,y,A){return f[y.toLowerCase()]=A,""}).replace(/^\n+|\n+$/g,"");n=o.exec(t);)g=t.substring(c,n.index),c=o.lastIndex,p=n[0],g.match(/[^\\](\\\\)*\\$/)||(n[3]||n[4]?p='<pre class="code '+(n[4]?"poetry":n[2].toLowerCase())+'">'+M(k(n[3]||n[4]).replace(/^\n+|\n+$/g,""))+"</pre>":n[6]?((h=n[6]).match(/\./)&&(n[5]=n[5].replace(/^\d+/gm,"")),b=T(M(n[5].replace(/^\s*[>*+.-]/gm,""))),">"===h?h="blockquote":(h=h.match(/\./)?"ol":"ul",b=b.replace(/^(.*)(\n|$)/gm,"<li>$1</li>")),p="<"+h+">"+b+"</"+h+">"):n[8]?p='<img src="'+k(n[8])+'" alt="'+k(n[7])+'">':n[10]?(a=a.replace("<a>",'<a href="'+k(n[11]||f[g.toLowerCase()])+'">'),p=R()+"</a>"):n[9]?p="<a>":n[12]||n[14]?p="<"+(h="h"+(n[14]?n[14].length:"="===n[13][0]?1:2))+">"+T(n[12]||n[15])+"</"+h+">":n[16]?p="<code>"+k(n[16])+"</code>":(n[17]||n[1])&&(p=Y(n[17]||"--"))),a+=g,a+=p;return(a+t.substring(c)+R()).trim()};var W=w(9946),V=w.n(W);let x;const D={faster:.5,fast:.75,normal:1,slow:1.25,slower:1.5};function d(t){return L.apply(this,arguments)}function L(){return(L=(0,s.A)(function*(t){yield new Promise(o=>{setTimeout(o,t)})})).apply(this,arguments)}function u(t,o,r={ignoreCase:!0,replacement:[]}){return(0,s.A)(function*(){const a=document.querySelector(t);if(2===r.replacement?.length){x||(x=(yield(yield fetch("/rest/admin/application-configuration")).json()).config);const c=r.replacement[1].split(".");let f=x;for(const p of c)f=f[p];o=o.replace(r.replacement[0],f)}for(;(!r.ignoreCase||a.value.toLowerCase()!==o.toLowerCase())&&(r.ignoreCase||a.value!==o);)yield d(100)})}function O(t,o,r={ignoreCase:!0}){return(0,s.A)(function*(){const a=document.querySelector(t);for(;;){if(""!==a.value){if(r.ignoreCase&&a.value.toLowerCase()!==o.toLowerCase())break;if(!r.ignoreCase&&a.value!==o)break}yield d(100)}})}function P(t){return(0,s.A)(function*(){const o=document.querySelector(t);for(;!o.value||""===o.value;)yield d(100)})}function l(t){return(0,s.A)(function*(){const o=document.querySelector(t);o||console.warn(`Could not find Element with selector "${t}"`),yield new Promise(r=>{o.addEventListener("click",()=>{r()})})})}function S(t,o){return(0,s.A)(function*(){for(;;){const r=document.querySelector(t);if(r&&r.innerHTML===o)break;yield d(100)}})}function e(t){return(0,s.A)(function*(){x||(x=(yield(yield fetch("/rest/admin/application-configuration")).json()).config);let o=D[x.hackingInstructor.hintPlaybackSpeed];o??=1,yield d(t*o)})}function i(t){return(0,s.A)(function*(){for(;!window.location.hash.startsWith(`#/${t}`);)yield d(100)})}function C(){return(0,s.A)(function*(){for(;null===localStorage.getItem("token");)yield d(100)})}function _(){return(0,s.A)(function*(){for(;null!==localStorage.getItem("token");)yield d(100)})}function I(){const t=window.innerHeight,o=window.innerWidth;return(0,s.A)(function*(){for(;window.innerHeight===t&&window.innerWidth===o;)yield d(100)})}const G={name:"Login Admin",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:_()},{text:"Let's try if we find a way to log in with the administrator's user account. To begin, go to the _Login_ page via the _Account_ menu.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("login")},{text:"To find a way around the normal login process we will try to use a **SQL Injection** (SQLi) attack.",fixture:"#email",resolved:e(8e3)},{text:"A good starting point for simple SQL Injections is to insert quotation marks (like `\"` or `'`). These mess with the syntax of an insecurely concatenated query and might give you feedback if an endpoint is vulnerable or not.",fixture:"#email",resolved:e(15e3)},{text:"Start with entering `'` in the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","'")},{text:"Now put anything in the **password field**. It doesn't matter what.",fixture:"#password",unskippable:!0,resolved:P("#password")},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"Nice! Do you see the red `[object Object]` error at the top? Unfortunately it isn't really telling us much about what went wrong...",fixture:"#rememberMe",resolved:e(1e4)},{text:"Maybe you will be able to find out more information about the error in the JavaScript console or the network tab of your browser!",fixture:"#rememberMe",resolved:e(1e4)},{text:"Did you spot the error message with the `SQLITE_ERROR` and the entire SQL query in the 500 response to `/login`? If not, keep the network tab open and click _Log in_ again. Then inspect the occurring response closely.",fixture:"#rememberMe",resolved:e(3e4)},{text:"Let's try to manipulate the query a bit to make it useful. Try out typing `' OR true` into the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","' OR true")},{text:"Now click the _Log in_ button again.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"Mhh... The query is still invalid? Can you see why from the new error in the HTTP response?",fixture:"#rememberMe",resolved:e(8e3)},{text:"We need to make sure that the rest of the query after our injection doesn't get executed. Any Ideas?",fixture:"#rememberMe",resolved:e(8e3)},{text:"You can comment out anything after your injection payload from query using comments in SQL. In SQLite databases you can use `--` for that.",fixture:"#rememberMe",resolved:e(1e4)},{text:"So, type in `' OR true--` into the email field.",fixture:"#email",unskippable:!0,resolved:u("#email","' OR true--")},{text:"Press the _Log in_ button again and sit back...",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"That worked, right?! To see with whose account you just logged in, open the _Account_ menu.",fixture:"#navbarAccount",unskippable:!0,resolved:l("#navbarAccount")},{text:"\u{1f389} Congratulations! You have been logged in as the **administrator** of the shop! (If you want to understand why, try to reproduce what your `' OR true--` did _exactly_ to the query.)",fixture:"app-navbar",resolved:e(2e4)}]},$={name:"DOM XSS",hints:[{text:"For this challenge, we'll take a close look at the _Search_ field at the top of the screen.",fixture:"#product-search-fixture",unskippable:!0,resolved:e(8e3)},{text:"Let's start by searching for all products containing `owasp` in their name or description.",fixture:"#product-search-fixture",unskippable:!0,resolved:u("#searchQuery input","owasp")},{text:"Now hit enter.",fixture:"#product-search-fixture",unskippable:!0,resolved:S("#searchValue","owasp")},{text:"Nice! You should now see many cool OWASP-related products.",fixture:"#product-search-fixture",resolved:e(8e3)},{text:"You might have noticed, that your search term is displayed above the results?",fixture:"app-search-result",resolved:e(8e3)},{text:"What we will try now is a **Cross-Site Scripting (XSS)** attack, where we try to inject HTML or JavaScript code into the application.",fixture:"app-search-result",resolved:e(15e3)},{text:"Change your search value into `<h1>owasp` to see if we can inject HTML.",fixture:"#product-search-fixture",unskippable:!0,resolved:u("#searchQuery input","<h1>owasp")},{text:"Hit enter again.",fixture:"#product-search-fixture",unskippable:!0,resolved:S("#searchValue","<h1>owasp</h1>")},{text:"Hmm, this doesn't look normal, does it?",fixture:".noResult",resolved:e(8e3)},{text:"If you right-click on the search term and inspect that part of the page with your browser, you will see that our `h1`-tag was _actually_ embedded into the page and is not just shown as plain text!",fixture:".noResult",resolved:e(16e3)},{text:"Let's now try to inject JavaScript. Type `<script>alert(xss)<\/script>` into the search box now.",fixture:"#product-search-fixture",unskippable:!0,resolved:u("#searchQuery input","<script>alert(xss)<\/script>")},{text:"Hit enter again.",fixture:"#product-search-fixture",unskippable:!0,resolved:S("#searchValue","<script>alert(xss)<\/script>")},{text:"\u{1f614} This didn't work as we hoped. If you inspect the page, you should see the `script`-tag but it is not executed for some reason.",fixture:".noResult",resolved:e(1e4)},{text:'Luckily there are _many_ different XSS payloads we can try. Let\'s try this one next: <code>&lt;iframe src="javascript:alert(&#96;xss&#96;)"&gt;</code>.',fixture:"#product-search-fixture",unskippable:!0,resolved:u("#searchQuery input",'<iframe src="javascript:alert(`xss`)">')},{text:"Hit enter one more time. If an alert box appears, you must confirm it in order to close it.",fixture:"#product-search-fixture",unskippable:!0,resolved:S("#searchValue",'<iframe src="javascript:alert(`xss`)"></iframe>')},{text:"\u{1f389} Congratulations! You just successfully performed an XSS attack!",fixture:".noResult",resolved:e(8e3)},{text:"More precisely, this was a **DOM XSS** attack, because your payload was handled and improperly embedded into the page by the application frontend code without even sending it to the server.",fixture:".noResult",resolved:e(16e3)}]},U={name:"Score Board",hints:[{text:"This application is riddled with security vulnerabilities. Your progress exploiting these is tracked on a _Score Board_.",fixture:"app-navbar",unskippable:!0,resolved:e(1e4)},{text:"You won't find a link to it in the navigation or side bar, though. Finding the _Score Board_ is in itself actually one of the hacking challenges.",fixture:"app-navbar",resolved:e(12e3)},{text:"You could just start guessing the URL of the _Score Board_ or comb through the client-side JavaScript code for useful information.",fixture:"app-navbar",resolved:e(12e3)},{text:"You find the JavaScript code in the DevTools of your browser that will open with `F12`.",fixture:"app-navbar",resolved:I()},{text:"Look through the client-side JavaScript in the _Sources_ tab for clues. Or just start URL guessing. It's up to you!",fixture:"app-navbar",unskippable:!0,resolved:i("score-board")},{text:"\u{1f389} Congratulations! You found the _Score Board_! Good luck and happy hacking!",fixture:"app-score-board",resolved:e(6e4)}]},X={name:"Privacy Policy",hints:[{text:"Log in with any user to begin this challenge. You can use an existing or freshly registered account.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:C()},{text:"Great, you are logged in! Now open the _Account_ menu.",fixture:"#navbarAccount",resolved:l("#navbarAccount")},{text:"Open the _Privacy & Security_ sub-menu and click _Privacy Policy_.",fixture:"app-navbar",unskippable:!0,resolved:i("privacy-security/privacy-policy")},{text:"\u{1f389} That was super easy, right? This challenge is a bit of a joke actually, because nobody reads any fine print online... \u{1f648}",fixture:"app-navbar",resolved:e(6e4)}]},z={name:"Login Jim",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:_()},{text:"Let's try if we find a way to log in with Jim's user account. To begin, go to the _Login_ page via the _Account_ menu.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("login")},{text:"As you would expect you need to supply Jim's email address and password to log in regularly. But you might have neither at the moment.",fixture:"app-navbar",resolved:e(15e3)},{text:"If we had at least the email address, we could then try a **SQL Injection** (SQLi) attack to avoid having to supply a password.",fixture:"app-navbar",resolved:e(15e3)},{text:"So, let's go find out Jim's email! Luckily the shop is very bad with privacy and leaks emails in different places, for instance in the product reviews.",fixture:"app-navbar",resolved:e(15e3)},{text:"Go back to the product list and click on some to open their details dialog which also hold the user reviews.",fixture:".fill-remaining-space",resolved:i("search")},{text:"Once you found a user review by Jim and learned his email, go to the _Login_ screen.",fixture:".fill-remaining-space",unskippable:!0,resolved:i("login")},{text:"Supply Jim's email address in the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","jim@juice-sh.op",{replacement:["juice-sh.op","application.domain"]})},{text:"Now put anything in the **password field**. Let's assume we don't know it yet, even if you happen to already do.",fixture:"#password",unskippable:!0,resolved:O("#password","ncc-1701")},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"This didn't work, but did you honestly expect it to? We need to craft an SQLi attack first!",fixture:"#rememberMe",resolved:e(1e4)},{text:"You can comment out the entire password check clause of the DB query by adding `'--` to Jim's email address!",fixture:"#email",unskippable:!0,resolved:u("#email","jim@juice-sh.op'--",{replacement:["juice-sh.op","application.domain"]})},{text:"Now click the _Log in_ button again.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"\u{1f389} Congratulations! You have been logged in as Jim!",fixture:"app-navbar",resolved:e(5e3)}]},K={name:"View Basket",hints:[{text:"This challenge is about **Horizontal Privilege Escalation**, meaning you are supposed to access data that does not belong to your own account but to another user's.",fixture:"app-navbar",resolved:e(18e3)},{text:"To start this challenge, you'll have to log in first.",fixture:"app-navbar",unskippable:!0,resolved:C()},{text:"First, go to the _Your Basket_ page to view your own shopping basket. It's likely to be empty, if you didn't add anything yet.",fixture:"app-navbar",unskippable:!0,resolved:i("basket")},{text:"To pass this challenge, you will need to peek into another user's basket while remaining logged in with your own account.",fixture:"app-navbar",resolved:e(8e3)},{text:"If the application stores a reference to the basket somewhere in the browser, that might be a possible attack vector.",fixture:"app-navbar",resolved:e(12e3)},{text:"Open the browser's _Development Tools_ and locate the _Session Storage_ tab. Similar to \u{1f36a}s, it can be used to store data in key/value pairs for each website.",fixture:"app-navbar",resolved:I()},{text:"Look over the names of the used session keys. Do you see something that might be related to the shopping basket? Try setting it to a different value! \u270d\ufe0f",fixture:"app-navbar",unskippable:!0,resolved:()=>(0,s.A)(function*(){const t=sessionStorage.getItem("bid");for(;sessionStorage.getItem("bid")===t;)yield d(100)})()},{text:"Great, you have changed the `bid` value which might be some ID for the shopping basket!",fixture:"app-navbar",resolved:e(8e3)},{text:"Now, go to any other screen and then back to _Your Basket_. If nothing happens you might have set an invalid or non-existing `bid`. Try another in that case.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:()=>(0,s.A)(function*(){const t=sessionStorage.getItem("itemTotal");for(;sessionStorage.getItem("itemTotal")===t;)yield d(100)})()},{text:"\u{1f389} Congratulations! You are now viewing another user's shopping basket!",fixture:"app-basket",resolved:e(15e3)}]},Z={name:"Forged Feedback",hints:[{text:"To start this challenge, first go to the _Customer Feedback_ page.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("contact")},{text:"This challenge is about broken access controls. To pass it, you need to impersonate another user while providing feedback.",fixture:"app-navbar",resolved:e(1e4)},{text:"If you would now submit feedback, it would be posted by yourself while logged in or anonymously while logged out.",fixture:"app-navbar",resolved:e(1e4)},{text:"We will now search for any mistake the application developers might have made in setting the author of any new feedback.",fixture:"app-navbar",resolved:e(1e4)},{text:"Open the browser's _Development Tools_ and try finding anything interesting while inspecting the feedback form.",fixture:"app-navbar",resolved:I()},{text:"There is more than meets the eye among the fields of the form... \u{1f609}",fixture:"app-navbar",resolved:e(8e3)},{text:"Once you found the field that shouldn't even be there, try manipulating its value to one that might represent another user!",fixture:"app-navbar",unskippable:!0,resolved:()=>(0,s.A)(function*(){const t=document.getElementById("userId").value;for(;document.getElementById("userId").value===t;)yield d(100)})()},{text:"You found and changed the invisible `userId`! Now submit the form to complete the challenge.",fixture:"app-navbar",unskippable:!0,resolved:l("#submitButton")},{text:"\u{1f389} Congratulations, you successfully submitted a feedback as another user!",fixture:"app-navbar",resolved:e(15e3)}]},ee={name:"Password Strength",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:_()},{text:"In this challenge we'll try to log into the administrator's user account using his original credentials.",fixture:"app-navbar",resolved:e(7e3)},{text:"If you don't know it already, you must first find out the admin's email address. The user feedback and product reviews are good places to look into. When you have it, go to the _Login_ page.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("login")},{text:"Enter the admin's email address into the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","admin@juice-sh.op")},{text:"Now for the password. Lucky for us, the admin chose a really, really, **really** stupid one. Just try any that comes to your mind!",fixture:"#password",unskippable:!0,resolved:P("#password")},{text:"\u{1f926}\u200d\u2642\ufe0f Nah, that was wrong! Keep trying! I'll tell you when you're one the right track.",fixture:"#password",unskippable:!0,resolved:u("#password","admin")},{text:"Okay, you are one the right track, but this would have been the worst password in the world for an admin. He spiced it up a little bit with some extra non-letter characters. Keep trying!",fixture:"#password",unskippable:!0,resolved:u("#password","admin1")},{text:"\u{1f525} Yes, it's getting warmer! Try adding some more numbers maybe?",fixture:"#password",unskippable:!0,resolved:u("#password","admin12")},{text:"\u{1f9ef} It's getting hot! Just one more digit...",fixture:"#password",unskippable:!0,resolved:u("#password","admin123")},{text:"Okay, now press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"\u{1f389} Congratulations! You have been logged in as the **administrator** of the shop thanks to his very ill chosen password!",fixture:"app-navbar",resolved:e(2e4)}]},te={name:"Bonus Payload",hints:[{text:"Assuming you did the **DOM XSS** tutorial already, this one just uses a funnier payload on the _Search_ field.",fixture:"#product-search-fixture",unskippable:!0,resolved:e(1e4)},{text:"Enter or paste this payload into the _Search_ field: <code>&lt;iframe width=&quot;100%&quot; height=&quot;166&quot; scrolling=&quot;no&quot; frameborder=&quot;no&quot; allow=&quot;autoplay&quot; src=&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&amp;color=%23ff5500&amp;auto&lowbar;play=true&amp;hide&lowbar;related=false&amp;show&lowbar;comments=true&amp;show&lowbar;user=true&amp;show&lowbar;reposts=false&amp;show&lowbar;teaser=true&quot;&gt;&lt;/iframe&gt;</code>.",fixture:"#product-search-fixture",unskippable:!0,resolved:u("#searchQuery input",'<iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true"></iframe>')},{text:"Make sure your speaker volume is cranked up. Then hit enter.",fixture:"#product-search-fixture",unskippable:!0,resolved:S("#searchValue",'<iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/771984076&color=%23ff5500&auto_play=true&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true"></iframe>')},{text:"\u{1f389} Congratulations and enjoy the music!",fixture:".noResult",resolved:e(5e3)}]},oe={name:"Login Bender",hints:[{text:"To start this challenge, you'll have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:_()},{text:"Let's try if we find a way to log in with Bender's user account. To begin, go to the _Login_ page via the _Account_ menu.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("login")},{text:"As you would expect you need to supply Bender's email address and password to log in regularly. But you might have neither at the moment.",fixture:"app-navbar",resolved:e(15e3)},{text:"If we had at least the email address, we could then try a **SQL Injection** (SQLi) attack to avoid having to supply a password.",fixture:"app-navbar",resolved:e(15e3)},{text:"So, let's go find out Bender's email! Luckily the shop is very bad with privacy and leaks emails in different places, for instance in the user feedback.",fixture:"app-navbar",resolved:e(15e3)},{text:"Go to the _About Us_ page where user feedback is displayed among other things.",fixture:"app-navbar",fixtureAfter:!0,resolved:i("about")},{text:"Once you found an entry by Bender in the feedback carousel leaking enough of his email to deduce the rest, go to the _Login_ screen.",fixture:"app-about",unskippable:!0,resolved:i("login")},{text:"Supply Bender's email address in the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","bender@juice-sh.op",{replacement:["juice-sh.op","application.domain"]})},{text:"Now put anything in the **password field**. Let's assume we don't know it yet, even if you happen to already do.",fixture:"#password",unskippable:!0,resolved:O("#password","OhG0dPlease1nsertLiquor!")},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"This didn't work, but did you honestly expect it to? We need to craft an SQLi attack first!",fixture:"#rememberMe",resolved:e(1e4)},{text:"You can comment out the entire password check clause of the DB query by adding `'--` to Bender's email address!",fixture:"#email",unskippable:!0,resolved:u("#email","bender@juice-sh.op'--",{replacement:["juice-sh.op","application.domain"]})},{text:"Now click the _Log in_ button again.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"\u{1f389} Congratulations! You have been logged in as Bender!",fixture:"app-navbar",resolved:e(5e3)}]},re={name:null,hints:[{text:"\u{1f613} Sorry, this hacking challenge does not have a step-by-step tutorial (yet) ... \u{1f9ed} Can you find your own way to solve it?",fixture:"app-navbar",resolved:e(15e3)},{text:"\u270d\ufe0f Do you want to contribute a tutorial for this challenge? [Check out our documentation](https://pwning.owasp-juice.shop/companion-guide/latest/part5/tutorials.html) to learn how! \u{1f3eb}",fixture:"app-navbar",resolved:e(15e3)},{text:"And now: \u{1f47e} **GLHF** with this challenge!",fixture:"app-navbar",resolved:e(1e4)}]},E=[U,G,z,$,X,K,Z,ee,te,oe,{name:"Coding Challenges",hints:[{text:"To do the tutorial on _Coding Challenges_, you have to find and visit the _Score Board_ first. Once there, you have to click the tutorial button for the _Score Board_ challenge to proceed.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("score-board")},{text:"Many Juice Shop hacking challenges come with an associated _Coding Challenge_ which will teach you more about the underlying vulnerability on source code level.",fixture:"#Score\\ Board\\.solved",resolved:e(15e3)},{text:"You can launch a Coding Challenge via the `<>`-button. Click the one for the _Score Board_ challenge now.",fixture:"#codingChallengeTutorialButton",unskippable:!0,resolved:l("#Score\\ Board\\.codingChallengeButton")},{text:"All Coding Challenges take place in a modal dialog like this. They consist of two parts, one for finding and one for fixing the vulnerability in the code.",fixture:"#code-snippet",resolved:e(15e3)},{text:"The code snippet below shows a part of the actual application source code retrieved in real-time.",fixture:"#code-snippet",resolved:e(1e4)},{text:'You will always get a snippet that is involved in the security vulnerability or flaw behind the corresponding hacking challenge. In this case, you see the routing code that exposes all dialogs, including the supposedly "well-hidden" Score Board.',fixture:"#code-snippet",resolved:e(2e4)},{text:'For the "Find It" part of this coding challenge, tick the \u{1f532} on all lines of code that you think are responsible for exposing the Score Board. When done, click the _Submit_ button.',fixture:"#code-snippet",fixtureAfter:!0,unskippable:!0,resolved:l("#line114")},{text:"That's the one! Click the _Submit_ button proceed.",fixture:"#code-snippet",fixtureAfter:!0,unskippable:!0,resolved:l("#findItSubmitButton")},{text:"\u{1f38a}! You made it half-way through! In phase two you are now presented with several fix options. You must select the one which you think is the **best possible** fix for the security vulnerability.",fixture:"#code-snippet",resolved:e(1e4)},{text:'This coding challenge is a bit "special", because the Score Board is crucial for progress tracking and acts as a hub for the other challenges. Keep that in mind when picking the _Correct Fix_ from the options _Fix 1_, _2_ and _3_.',fixture:"#code-snippet",fixtureAfter:!0,unskippable:!0,resolved:l("#fixItSubmitButton")},{text:"If you did'nt get the answer right, just try again until the \u{1f38a}-cannon fires. Then click _Close_ to end the coding challenge and return to the Score Board.",fixture:"#code-snippet",fixtureAfter:!0,unskippable:!0,resolved:l("#fixItCloseButton")}]},{name:"Admin Section",hints:[{text:"For this challenge, you need to be logged in as an admin. If you have not done so yet, solve the admin login challenge first. Otherwise, log in as an admin.",fixture:".fill-remaining-space",unskippable:!1,resolved:function J(){return(0,s.A)(function*(){for(;;){let t="";try{const o=localStorage.getItem("token");t=V()(o).data.role}catch{console.log("Role from token could not be accessed.")}if("admin"===t)break;yield d(100)}})}()},{text:"A good way to start looking for an admin section is by understanding what technologies a website is built on. One way to do this is by clicking through the website and being attentive to hints. Start by opening the side menu (the hamburger icon in the top left corner).",fixture:".fill-remaining-space",unskippable:!0,resolved:l('button[aria-label="Open Sidenav"]')},{text:"Inspect those icons. Can you guess what they are?",fixture:".appVersion",fixtureAfter:!0,unskippable:!0,resolved:e(8e3)},{text:"This is the tech stack of the website. You see HTML, JavaScript, and more.",fixture:".appVersion",fixtureAfter:!0,unskippable:!0,resolved:e(8e3)},{text:"You could search for common web technologies and see if you recognize any logos.",fixture:".appVersion",fixtureAfter:!0,unskippable:!0,resolved:e(8e3)},{text:"And you will find that the first logo is Angular.",fixture:".appVersion",fixtureAfter:!0,unskippable:!0,resolved:e(8e3)},{text:"Close the side menu again.",fixture:".appVersion",fixtureAfter:!0,unskippable:!0,resolved:e(4e3)},{text:"These kinds of hints can tell you a lot. For example, if we found a WordPress site, a common admin path to look for would be /wp-admin.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:e(1e4)},{text:"In Angular, each route maps a URL path to a component. To find the admin section, try navigating to the /admin path and see what happens.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("admin")},{text:"Mmmmh, this did not work as expected. Let us try another one. Maybe /administration will work?",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:i("administration")},{text:"\u{1f389} Congratulations! You successfully accessed the admin section!",fixture:"app-navbar",resolved:e(6e3)},{text:'Most often, it is harder to find the tech stack. Instead of guessing common admin paths, another approach would be to use the developer tools. In this case, you would notice many "ng" references, which hint towards Angular. By understanding routes and paths in Angular, you could open the debugger, inspect the JavaScript files for paths, and find /administration.',fixture:"app-navbar",resolved:e(16e3)},{text:"Always keep your eyes open when inspecting a website. Once you have identified the technologies used, leverage them to your advantage, and do not forget to read the docs!",fixture:"app-navbar",resolved:e(1e4)},{text:"If you like, try to access the admin section without admin credentials. What do you think would happen? Happy hacking :)",fixture:"app-navbar",resolved:e(8e3)}]},{name:"Reflected XSS",hints:[{text:"To proceed with this challenge, you need to be logged in. We have detected that you are not currently logged in. Please log in to continue.",fixture:"#navbarAccount",unskippable:!0,resolved:C()},{text:'Start by going to your saved addresses. You can find them by clicking on "Account" in the navigation bar, then on Orders & Payment, and then on My saved addresses.',fixture:"app-navbar",unskippable:!0,resolved:i("address/saved")},{text:"Add a new address.",fixture:"app-navbar",unskippable:!0,resolved:i("address/create")},{text:"You see a few fields to submit input. This is always a good starting point for checking potential XSS vulnerabilities. Pay attention to the pop-up once you submitted the new address.",fixture:"app-navbar",unskippable:!0,resolved:i("address/saved")},{text:"Observe how the name of the city was used in the pop-up once you submit the address. Let us try to check whether this page is vulnerable to reflected XSS. Submit a new address.",fixture:"app-navbar",unskippable:!0,resolved:i("address/create")},{text:'Use: <code>&lt;iframe src="javascript:alert(&#96;xss&#96;)"&gt;</code> as a city name.',fixture:"app-navbar",unskippable:!0,resolved:i("address/saved")},{text:"Hmmm, that did not seem to work :/. We might want to try another part of the website. Let us explore the order and payment pages. First, place an order. You can add any item to your basket and complete the purchase.",fixture:"app-navbar",unskippable:!0,resolved:i("order-completion")},{text:"Have a look at the Track Orders page.",fixture:"app-navbar",unskippable:!0,resolved:i("track-result")},{text:'In a reflected XSS attack, a payload is often included in URI or HTTP parameters. Pay attention to the id parameter in the url. Could it be vulnerable to reflected XSS? Give it a try by replacing the value of the id parameter with the payload: <code>&lt;iframe src="javascript:alert(&#96;xss&#96;)"&gt;</code>. Do not enter immediately. We will let you know once you have the correct URL in place.',fixture:"app-navbar",resolved:function Q(t,o){return(0,s.A)(function*(){for(;;){const r=encodeURIComponent(o).replace(/%3A/g,":"),c=`#/track-result/new?${encodeURIComponent(t).replace(/%3A/g,":")}=${r}`;if(window.location.hash===c)break;yield d(100)}})}("id",'<iframe src="javascript:alert(`xss`)">')},{text:"That looks right! Now you can hit enter to solve this challenge. If an alert box appears, confirm it to close it. Happy hacking :)",fixture:"app-navbar",resolved:e(1e4)}]},{name:"Exposed credentials",hints:[{text:"To start this challenge, you will have to log out first.",fixture:"#navbarAccount",unskippable:!0,resolved:_()},{text:"As the challenge suggests, let us have a look at the client-side code. Open the dev tools.",fixture:"app-navbar",fixtureAfter:!0,unskippable:!0,resolved:I()},{text:"Go to Sources, and then inspect the main.js file. This is where all the client-side code is.",fixture:"app-navbar",resolved:e(1e4)},{text:"Now, why not search for some common words related to credentials? Maybe try password, pw, or username.",fixture:"app-navbar",resolved:e(35e3)},{text:"Once you found the hardcoded credentials, go to the login page.",fixture:"app-navbar",resolved:i("login")},{text:"Write the email address in the **email field**.",fixture:"#email",unskippable:!0,resolved:u("#email","testing@juice-sh.op",{replacement:["juice-sh.op","application.domain"]})},{text:"Now write the password in the **password field**.",fixture:"#password",unskippable:!0,resolved:u("#password","IamUsedForTesting")},{text:"Press the _Log in_ button.",fixture:"#rememberMe",unskippable:!0,resolved:l("#loginButton")},{text:"\u{1f389} Congratulations! You have been logged in with exposed credentials!",fixture:"app-navbar",resolved:e(5e3)}]}];function v(t,o,r={}){const a=document.createElement(t);Object.assign(a.style,o);for(const[c,f]of Object.entries(r))a.setAttribute(c,f);return a}function ue(t){const o=document.querySelector(t.fixture);if(!o)return null;const r=v("div",{position:"absolute"}),c=v("div",{position:"absolute",zIndex:"20000",backgroundColor:"rgba(50, 115, 220, 0.9)",maxWidth:"400px",minWidth:t.text.length>100?"350px":"250px",padding:"16px",borderRadius:"8px",whiteSpace:"initial",lineHeight:"1.3",top:"24px",fontFamily:"Roboto,Helvetica Neue,sans-serif",fontSize:"14px",display:"flex",alignItems:"center",cursor:t.unskippable?"default":"pointer",animation:"flash 0.2s"},{id:"hacking-instructor",title:t.unskippable?"":"Double-click to skip"}),p=v("img",{minWidth:"64px",minHeight:"64px",width:"64px",height:"64px",marginRight:"8px"},{src:"/assets/public/images/hackingInstructor.png"}),g=v("span",{flexGrow:"2"});g.innerHTML=N(t.text);const b=v("button",{textDecoration:"none",backgroundColor:"transparent",border:"none",color:"white",fontSize:"large",position:"relative",zIndex:"20001",top:"32px",left:"5px",cursor:"pointer"},{id:"cancelButton",title:"Cancel the tutorial"});b.innerHTML="<div>&times;</div>",c.appendChild(p),c.appendChild(g);const h=v("div",{position:"relative",display:"inline"});return h.appendChild(c),h.appendChild(b),r.appendChild(h),o.parentElement.insertBefore(r,t.fixtureAfter?o.nextSibling:o),r}function le(t){return B.apply(this,arguments)}function B(){return(B=(0,s.A)(function*(t){return yield new Promise(o=>{t.addEventListener("dblclick",o)})})).apply(this,arguments)}function de(t){return j.apply(this,arguments)}function j(){return(j=(0,s.A)(function*(t){return yield new Promise(o=>{t.addEventListener("click",()=>{o("break")})})})).apply(this,arguments)}function ce(t){return void 0!==E.find(({name:o})=>o===t)}function pe(t){const o=t.getBoundingClientRect();return o.top>=0&&o.left>=0&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&o.right<=(window.innerWidth||document.documentElement.clientWidth)}function he(t){return F.apply(this,arguments)}function F(){return(F=(0,s.A)(function*(t){const o=E.find(({name:r})=>r===t)??re;for(const r of o.hints){const a=ue(r);if(!a){console.warn(`Could not find Element with fixture "${r.fixture}"`);continue}pe(a)||a.scrollIntoView();const c=[r.resolved()];if(r.unskippable||c.push(le(a)),c.push(de(document.getElementById("cancelButton"))),"break"===(yield Promise.race(c))){a.remove();break}a.remove()}})).apply(this,arguments)}}}]);